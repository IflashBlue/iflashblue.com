{{ form_start(form) }}
<div class="row g-3">
    <div class="col-xs-12 col-md-6">
        <div class="card shadow p-3 mb-5 bg-body rounded border-0">
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-12">
                        {{ form_row(form.order) }}
                        {{ form_row(form.highlight) }}
                        {{ form_row(form.category) }}
                    </div>
                    <div class="col-12">
                        <div class="accordion" id="accordionTranslation">
                            {% for key, translation in form.translations %}
                                <div class="accordion-item">
                                    <h2 class="accordion-header" id="heading_{{ key }}">
                        <span
                            class="accordion-button"
                            type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#collapse_{{ key }}"
                            aria-expanded="true"
                            aria-controls="collapse_{{ key }}">
                            <img src="{{ asset('images/flags/' ~key~ '.svg' ) }}" class="flag-translations"
                                 alt="{{ key }}" title="{{ key }}">
                        </span>
                                    </h2>
                                    <div id="collapse_{{ key }}"
                                         class="accordion-collapse collapse show"
                                         aria-labelledby="heading_{{ key }}"
                                         data-bs-parent="#accordionTranslation">
                                        <div class="accordion-body">
                                            {{ form_row(translation.title) }}
                                            {{ form_row(translation.description) }}
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="col-12">
                        <input type="submit" class="btn btn-primary" value="{{ 'admin.actions.save'|trans }}">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xs-12 col-md-6">
        <div class="col-xs-12 col-md-8">
            <div class="card shadow p-3 mb-5 bg-body rounded border-0">
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-12">
                            <h2 class="text-primary">{{ form_label(form.images) }}</h2>
                        </div>
                        <div class="col-12">
                            {{ form_errors(form.images) }}
                            <div class="row g-3"
                                 id="images-collection"
                                 data-prototype="{{ form_widget(form.images.vars.prototype)|e }}"
                                 data-counter="{{ form.images|length }}"
                            >
                                {% for image in form.images %}
                                    <div class="col-12 border-bottom">
                                        {{ form_row(image.order) }}
                                        {{ form_row(image.image) }}
                                        <button type="button" onclick="deleteElement(event)"
                                                class="btn btn-outline-danger btn-block col-12 mb-3 delete-collection-widget">
                                            {{ 'admin.collection.remove'|trans }}
                                        </button>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                        <input
                            type="button"
                            class="btn btn-outline-primary btn-block"
                            id="add-another-collection-widget"
                            value="{{ 'admin.collection.add'|trans }}"/>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{{ form_end(form) }}
<script>
    var myButton = document.querySelector("#add-another-collection-widget");

    function deleteElement(e) {
        var div = e.target.parentNode;
        var container = div.parentNode;
        container.removeChild(div);
        console.log(div, container);
    }

    function createElementFromHTML(htmlString) {
        var div = document.createElement('div');
        div.innerHTML = htmlString.trim();

        // Change this to div.childNodes to support multiple top-level nodes.
        return div.firstChild;
    }

    function addElementToCollection() {
        var divPrototype = document.querySelector("#images-collection")
        var newWidget = divPrototype.dataset.prototype;
        var counter = divPrototype.dataset.counter || divPrototype.childElementCount;

        newWidget = '<div class="col-12 border-bottom">' + newWidget.replace(/__name__/g, counter) + '</div>';
        counter++;
        divPrototype.dataset.counter = counter;
        divPrototype.appendChild(createElementFromHTML(newWidget));
    }

    myButton.onclick = addElementToCollection;


</script>
